img = SquareImage(rows=4, cols=4, l=2, calibration_value=1, background=0)
@testset "Testing Radon transform" begin
    @test img ≈ [
        [0 0 0 0];
        [0 1 1 0];
        [0 1 1 0];
        [0 0 0 0]
    ]
    @testset "Testing diag algorithm" begin
        sinog = radon(img, Radon())
        @test sinog ≈ [
            [0.323768   0.398227  0.0333993  0.0        0.00320944];
            [0.552707   0.598481  0.26336    0.0381159  0.169034];
            [0.552707   0.571367  0.531972   0.254671   0.485982];
            [0.396378   0.31396   0.584379   0.55076    0.558656];
            [0.0837195  0.037928  0.367927   0.632487   0.494877];
            [0.0        0.0       0.0966751  0.401678   0.208203]
        ]
    end
    @testset "Testing square algorithm" begin
        sinog = radon(img, RadonSquare())
        @test sinog ≈ [
            [0.0       0.05596    0.044909  0.064763   0.0647629  0.044909  0.05596];
            [0.888889  0.764706   0.846043  0.804828   0.804828   0.846043  0.764706];
            [0.888889  0.764706   0.846043  0.804828   0.804828   0.846043  0.764706];
            [0.0       0.0559601  0.044909  0.0647629  0.0647629  0.044909  0.05596]
        ]
    end
end
